<!DOCTYPE html>
<html>

<head>
  <title>Chat App</title>
  <link rel="stylesheet" href="styles.css">
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@8"></script>
</head>

<body>
  <form id="container">
    <input id="name" type="text" name="name" value="" placeholder="Please enter your name">
    <button type="button" name="button" onclick="setUsername()">
      Chat now!
    </button>
  </form>
  <div id="error-container"></div>
</body>

<script src="/socket.io/socket.io.js"></script>
<script>
  var socket = io();
  function setUsername() {
    socket.emit('setUsername', document.getElementById('name').value);
  };
  var user;
  socket.on('userExists', function (data) {
    document.getElementById('error-container').innerHTML = data;
  });
  socket.on('userSet', function (data) {
    user = data.username;
    document.body.innerHTML = '<div id = "message-container"></div>\
         <form id="send-container">\
          <input type = "text" id = "message">\
          <button type = "button" name = "button" onclick = "sendMessage()">Send</button>\
         </form>';
  });
  function sendMessage() {
    var msg = document.getElementById('message').value;
    if (msg) {
      socket.emit('msg', { message: msg, user: user });
    }
  }
  socket.on('msg', function (data) {
    if (user) {
      document.getElementById('message-container').innerHTML += '<div><b>' +
        data.user + '</b>: ' + data.message + '</div>'
    }
  })
</script>

</html>