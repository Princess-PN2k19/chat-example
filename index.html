<!DOCTYPE html>
<html>

<head>
  <title>Chat App</title>
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@8"></script>
</head>
<style>
  body {
    background-image: url("http://blog.visme.co/wp-content/uploads/2017/07/50-Beautiful-and-Minimalist-Presentation-Backgrounds-03.jpg");
    font: 13px Helvetica, Arial;
    padding: 0;
    margin: 0;
    display: flex;
    justify-content: center;
  }

  #container {
    position: fixed;
    padding-bottom: 20px;
    bottom: 0;
    max-width: 1200px;
    width: 80%;
    display: flex;
  }

  #send-container {
    position: fixed;
    padding-bottom: 30px;
    bottom: 0;
    max-width: 1200px;
    width: 80%;
    display: flex;
  }

  #message-container {
    width: 80%;
    max-width: 1200px;
  }

  #message-container div {
    background-color: #CCC;
    padding: 5px;
  }

  #message-container div:nth-child(2n) {
    background-color: #FFF;
  }

  #message {
    flex-grow: 1;
  }
</style>

<body>
  <!-- <form id="container">
    <input id="name" type="text" name="name" value="" placeholder="Please enter your name">
    <button type="button" name="button" onclick="setUsername()">
      Chat now!
    </button>
  </form>
  <div id="error-container"></div> -->
</body>

<script src="/socket.io/socket.io.js"></script>
<script>
  (async () => {

    const { value: email } = await Swal.fire({
      title: 'Input email address',
      input: 'email',
      inputPlaceholder: 'Enter your email address'
    })

    if (email) {
      Swal.fire('Entered email: ' + email)
    }

  })()

  var socket = io();
  function setUsername() {
    socket.emit('setUsername', document.getElementById('name').value);
  };
  var user;
  socket.on('userExists', function (data) {
    document.getElementById('error-container').innerHTML = data;
  });
  socket.on('userSet', function (data) {
    user = data.username;
    document.body.innerHTML = '<div id = "message-container"></div>\
         <form id="send-container">\
          <input type = "text" id = "message">\
          <button type = "button" name = "button" onclick = "sendMessage()">Send</button>\
         </form>';
  });
  function sendMessage() {
    var msg = document.getElementById('message').value;
    if (msg) {
      socket.emit('msg', { message: msg, user: user });
    }
  }
  socket.on('msg', function (data) {
    if (user) {
      document.getElementById('message-container').innerHTML += '<div><b>' +
        data.user + '</b>: ' + data.message + '</div>'
    }
  })
</script>

</html>